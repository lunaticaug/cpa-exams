# 범용 문서 자동 변환 시스템

## 1. Overview
사용자가 **PDF 또는 DOCX** 파일을 업로드하면, Claude가 자동으로 내용을 분석하여 적절한 형식(마크다운, CSV, JSON 등)으로 변환한다.

## 2. 자동 처리 절차

### Step 1: 즉시 시작
- **PDF/DOCX 업로드 시 질문 없이 바로 작업 시작**
- "문서를 읽고 변환하겠습니다" 메시지 출력
- 파일 형식 자동 감지 (PDF/DOCX)

### Step 2: 파일 형식별 처리
```javascript
// 파일 형식별 처리 로직
if (파일확장자 === ".pdf") {
    처리방식 = "PDF 텍스트 추출";
} else if (파일확장자 === ".docx") {
    처리방식 = "DOCX 구조 분석 (mammoth 라이브러리)";
    // DOCX는 더 정확한 구조 정보 제공
}
```

### Step 3: 내용 분석 및 구조 파악
```
- 문서 유형 자동 감지 (시험지, 보고서, 논문, 매뉴얼 등)
- 총 페이지 수 확인
- 주요 구조 요소 식별:
  * 제목/부제목 계층 (DOCX에서 더 정확)
  * 표/목록 구조 (DOCX에서 완벽 보존)
  * 문제/답안 형식
  * 이미지/도표 위치
  * 페이지 번호/헤더
```

### Step 4: 최적 형식 결정
```javascript
// 자동 형식 결정 로직
if (문서타입 === "시험지" || "문제집") {
    형식 = "마크다운 + 구조화된 JSON";
} else if (문서타입 === "보고서" || "논문") {
    형식 = "마크다운";
} else if (문서타입 === "데이터표" || "명세서") {
    형식 = "CSV + JSON";
} else {
    형식 = "마크다운"; // 기본값
}

// DOCX 전용 추가 옵션
if (파일형식 === "DOCX") {
    추가옵션 = {
        "스타일보존": true,
        "표구조완벽": true,
        "주석포함": true
    };
}
```

### Step 5: 변환 실행
- **원본 내용 100% 보존** (요약/가공 금지)
- **Artifact 제목은 원본 파일명 사용 (확장자만 .md/.json/.csv로 변경)**
- 한국어 인코딩 검증
- 불필요한 개행/공백 정리
- Artifact로 결과 제공

### Step 6: 결과 보고
```
✅ 변환 완료 보고:
- 파일 형식: [PDF/DOCX]
- 문서 유형: [자동 감지된 타입]
- 총 페이지: XX페이지
- 변환 형식: [선택된 형식]
- 주요 구조: [감지된 구조 요소들]
- 특이사항: [있다면 언급]
```

## 3. 파일 형식별 장점

### DOCX 처리 장점
```
✅ 정확한 표 구조 추출
✅ 완벽한 제목 계층 보존  
✅ 스타일/서식 정보 활용
✅ 주석/각주 포함 가능
✅ 목록 구조 정확한 변환
```

### PDF 처리 특징
```
⚠️ 스캔된 이미지 PDF는 OCR 불가
⚠️ 표 구조 복원 제한적
✅ 레이아웃 정보 보존
✅ 페이지 단위 처리 가능
```

## 4. 처리 가능 범위

### 페이지 제한
- **DOCX**: 더 효율적, 100-150페이지 안정적
- **PDF**: 50-100페이지 권장
- **최대**: 토큰 제한에 따라 결정

### 대용량 처리 방식
```
if (페이지수 > 적정한도) {
    console.log("📊 대용량 문서 감지");
    console.log("🔄 분할 처리를 권장합니다");
    
    분할옵션 = [
        "챕터별 분할 (DOCX 제목 기준)",
        "페이지 범위별 분할",
        "섹션별 분할"
    ];
}
```

## 5. 자동화 트리거 문구

**사용자가 이렇게 말하면 자동 실행:**
- "문서 변환해줘"
- "PDF/워드 마크다운으로 바꿔줘"  
- "DOCX 변환"
- **파일 업로드만 해도 자동 감지**

## 6. 실제 사용 프롬프트

```
# 범용 문서 자동 변환 시스템

사용자가 PDF 또는 DOCX를 업로드하면:

1. **파일 형식 자동 감지** (PDF/DOCX)
2. **즉시 분석 시작** (질문 없이)
3. **문서 구조 자동 파악**:
   - 문서 유형 감지
   - 페이지 수 및 구조 분석
   - 표/목록/이미지 위치 파악
4. **최적 형식 자동 선택**:
   - 시험지 → 마크다운 + 답안양식
   - 보고서 → 마크다운 + 계층구조
   - 데이터 → CSV/JSON
5. **변환 실행**:
   - 원본 내용 100% 보존
   - 파일별 최적화 처리
   - Artifact로 제공
6. **결과 요약 보고**

⚠️ 중요: 내용 요약/가공 금지, 원본 그대로 변환
```

## 7. 고급 기능

### 파일 형식별 전용 기능
```python
# DOCX 전용
docx_features = {
    "주석_추출": True,
    "스타일_매핑": True,
    "표_병합셀": True,
    "각주_포함": True
}

# PDF 전용  
pdf_features = {
    "페이지_분할": True,
    "레이아웃_보존": True,
    "이미지_위치": True
}
```